# 用户分数排行榜

#### 介绍
**该服务实现用户信息存储和为用户提供分数和排名**

#### 业务模式

1.  用户：每个用户都由一个唯一的CustomerID标识，这是一个int64数字。在这个服务，任何任意数字都可以识别用户。
2.  分数：每个用户都有分数，这是一个十进制数字。用户的默认得分为零。
3.  排行榜：所有得分大于零的用户都参加比赛。
每个用户在排行榜上与一个独特的排名相关联，该排名由他们的分数决定。
<br>得分最高的排名第一
<br>得分第二高的用户排名第二
<br>... 
4.  两个得分相同的用户，他们的排名由他们的用户ID决定，ID小的排行在前。
5.  当用户的分数发生变化时，其排名排行榜会实时受到影响。

#### 非功能需求

1.  不需要存在数据库，状态只在内存中。
2.  只能使用NetCore，不要使用外部框架/组件用于测试。
3.  该服务需要能够处理大量同时进行的请求。
4.  这项服务需要能够处理很多用户，所以请记住复杂性，尤其是频繁操作的时间复杂性。
5.  在github上创建一个存储库，并将源代码上传到那里。

#### 功能需求

1.  更新分数
2.  按排名获取用户
3.  按customerid获取用户

#### 涉及技术

1.  ILogger
2.  IMemoryCache
3.  ChannelContext
4.  List<<span>T</span>>
5.  Thread 

#### 实现逻辑 

1.  更新分数 
<br>1.1.获取用户信息,包含分数。
<br>1.2.追加分数,小于0时,默认为0。
<br>1.3.将当前用户信息异步写入无界限队列做分数排行。
<br>1.4.返回更新后的数据。

2.  按排名获取用户
<br>2.1.基础传参校验,开始排名必须小于结束排名。
<br>2.2.获取用户缓存信息,取得用户排行榜。
<br>2.3.校验当前排行是否存在用户信息,存在则根据排名获取索引和计算所需要取出的排行行数。
<br>2.4.返回当前查询用户排行结果。


3.  按customerid获取用户
<br>3.1.获取用户排行信息
<br>3.2.按customerid获取用户,不存在则返回
<br>3.3.按当前用户信息获取在排行中的索引,根据排名和计算所需要取出的排行行数。
<br>3.4.返回当前查询用户排行结果。